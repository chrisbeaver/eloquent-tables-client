(function () {
'use strict';

var tables = document.getElementsByClassName('eloquent-table');
var headers = [].slice.call(tables[0].tHead.querySelectorAll('th')).map(function (header) {
    return header.innerHTML;
});
var paginator = document.createElement('div');
var total_count = { value: 0,
    set: function set(value) {
        this.value = value;
    }
};
var rows = {
    collection: null,
    set: function set(value) {
        this.collection = value;
    }
};

/**
 * Construct basic framework for creating a table.
 */
function initializeTable() {
    var wrapper = document.createElement('div');
    wrapper.className = 'table-wrapper';
    var table = tables[0];

    document.body.insertBefore(wrapper, table);
    wrapper.appendChild(table);

    // paginator = document.createElement("div");
    paginator.className = 'paginator';
    wrapper.appendChild(paginator);
}

/**
 * Fired on AJAX response to construct paginated results.
 *
 */
function buildPaginator() {
    // console.log('Count: ' + total_count);
    paginator.innerHTML = total_count.value;
}

/**
 * AJAX Listener to build table with data returned 
 * from server.
 *
 * @param  {Json} payload a server response
 */
function populateTable(payload) {
    // console.log(tables);
    payload.data.forEach(function (data) {

        var row = tables[0].getElementsByTagName('tbody')[0].insertRow(-1);
        // Insert new cells (<td> elements) at the 1st and 2nd position of the "new" <tr> element:
        var cell1 = row.insertCell(0);
        var cell2 = row.insertCell(1);
        var cell3 = row.insertCell(2);
        var cell4 = row.insertCell(3);

        // Add some text to the new cells:
        cell1.innerHTML = data.id;
        cell2.innerHTML = data.company.name;
        cell3.innerHTML = data.name;
        cell4.innerHTML = data.price;
    });
    // console.log(paginator);
    total_count.set(payload.count);
    buildPaginator();
}

/**
 * AJAX Request to server to get Table data.
 */
function ajaxRequest() {
    var r = new XMLHttpRequest();

    r.open('POST', tables[0].getAttribute('data-target'), true);
    r.setRequestHeader('X-CSRF-TOKEN', '{{ csrf_token() }}');
    r.setRequestHeader('take', '10');
    r.setRequestHeader('skip', '5');
    r.setRequestHeader('search', 'Wiza');
    r.addEventListener('load', ajaxListener);
    r.onreadystatechange = function () {
        if (r.readyState != 4 || r.status != 200) return;
        // console.log(r.responseText);
    };
    r.send('take=1');
}

/**
 * Call back function fired on AJAX result.
 */
function ajaxListener() {
    // console.log(JSON.parse(this.responseText));
    rows.set(JSON.parse(this.responseText));
    // console.log(rows.collection);
    populateTable(rows.collection);
}

initializeTable();
ajaxRequest();

}());
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjpudWxsLCJzb3VyY2VzIjpbIi4uLy4uL3NyYy9zY3JpcHRzL2dsb2JhbHMuanMiLCIuLi8uLi9zcmMvc2NyaXB0cy9tb2R1bGVzL2luaXRpYWxpemVUYWJsZS5qcyIsIi4uLy4uL3NyYy9zY3JpcHRzL21vZHVsZXMvcGFnaW5hdG9yLmpzIiwiLi4vLi4vc3JjL3NjcmlwdHMvbW9kdWxlcy9wb3B1bGF0ZVRhYmxlLmpzIiwiLi4vLi4vc3JjL3NjcmlwdHMvbW9kdWxlcy9hamF4UmVxdWVzdC5qcyIsIi4uLy4uL3NyYy9zY3JpcHRzL21haW4uanMiXSwic291cmNlc0NvbnRlbnQiOlsiZXhwb3J0IGxldCB0YWJsZXMgPSBkb2N1bWVudC5nZXRFbGVtZW50c0J5Q2xhc3NOYW1lKCdlbG9xdWVudC10YWJsZScpO1xuZXhwb3J0IGxldCBoZWFkZXJzID0gW10uc2xpY2VcbiAgICAuY2FsbCh0YWJsZXNbMF0udEhlYWQucXVlcnlTZWxlY3RvckFsbCgndGgnKSlcbiAgICAubWFwKGZ1bmN0aW9uKGhlYWRlcikge1xuICAgICAgICByZXR1cm4gaGVhZGVyLmlubmVySFRNTDtcbiAgICB9KTtcbmV4cG9ydCBsZXQgcGFnaW5hdG9yID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7XG5leHBvcnQgbGV0IHRvdGFsX2NvdW50ID0geyB2YWx1ZTogMCxcbiAgICBzZXQ6IGZ1bmN0aW9uKHZhbHVlKSB7XG5cdFx0dGhpcy52YWx1ZSA9IHZhbHVlO1xuIFx0fVxufTtcbmV4cG9ydCBsZXQgcm93cyA9IHsgXG5cdGNvbGxlY3Rpb246IG51bGwsXG5cdHNldDogZnVuY3Rpb24odmFsdWUpIHtcblx0XHR0aGlzLmNvbGxlY3Rpb24gPSB2YWx1ZTtcblx0fVxufTsiLCJpbXBvcnQgeyB0YWJsZXMsIHBhZ2luYXRvciB9IGZyb20gJy4uL2dsb2JhbHMnO1xuLyoqXG4gKiBDb25zdHJ1Y3QgYmFzaWMgZnJhbWV3b3JrIGZvciBjcmVhdGluZyBhIHRhYmxlLlxuICovXG5leHBvcnQgZnVuY3Rpb24gaW5pdGlhbGl6ZVRhYmxlKClcbntcbiAgICBsZXQgd3JhcHBlciA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpO1xuICAgIHdyYXBwZXIuY2xhc3NOYW1lID0gJ3RhYmxlLXdyYXBwZXInO1xuICAgIGxldCB0YWJsZSA9IHRhYmxlc1swXTtcbiAgICBcbiAgICBkb2N1bWVudC5ib2R5Lmluc2VydEJlZm9yZSh3cmFwcGVyLCB0YWJsZSk7XG4gICAgd3JhcHBlci5hcHBlbmRDaGlsZCh0YWJsZSk7XG5cbiAgICAvLyBwYWdpbmF0b3IgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiZGl2XCIpO1xuICAgIHBhZ2luYXRvci5jbGFzc05hbWUgPSAncGFnaW5hdG9yJztcbiAgICB3cmFwcGVyLmFwcGVuZENoaWxkKHBhZ2luYXRvcik7XG59IiwiaW1wb3J0IHsgcGFnaW5hdG9yLCB0b3RhbF9jb3VudCB9IGZyb20gJy4uL2dsb2JhbHMnO1xuLyoqXG4gKiBGaXJlZCBvbiBBSkFYIHJlc3BvbnNlIHRvIGNvbnN0cnVjdCBwYWdpbmF0ZWQgcmVzdWx0cy5cbiAqXG4gKi9cbiAgICBleHBvcnQgZnVuY3Rpb24gYnVpbGRQYWdpbmF0b3IoKVxuICAgIHtcbiAgICAgICAgLy8gY29uc29sZS5sb2coJ0NvdW50OiAnICsgdG90YWxfY291bnQpO1xuICAgICAgICBwYWdpbmF0b3IuaW5uZXJIVE1MID0gdG90YWxfY291bnQudmFsdWU7XG4gICAgfSIsImltcG9ydCB7IHRhYmxlcywgdG90YWxfY291bnQgfSBmcm9tICcuLi9nbG9iYWxzJztcbmltcG9ydCB7IGJ1aWxkUGFnaW5hdG9yIH0gZnJvbSAnLi9wYWdpbmF0b3InO1xuLyoqXG4gKiBBSkFYIExpc3RlbmVyIHRvIGJ1aWxkIHRhYmxlIHdpdGggZGF0YSByZXR1cm5lZCBcbiAqIGZyb20gc2VydmVyLlxuICpcbiAqIEBwYXJhbSAge0pzb259IHBheWxvYWQgYSBzZXJ2ZXIgcmVzcG9uc2VcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIHBvcHVsYXRlVGFibGUocGF5bG9hZClcbntcbiAgICAvLyBjb25zb2xlLmxvZyh0YWJsZXMpO1xuICAgIHBheWxvYWQuZGF0YS5mb3JFYWNoKGZ1bmN0aW9uKGRhdGEpIHtcbiAgICAgICAgXG4gICAgICAgIHZhciByb3cgPSB0YWJsZXNbMF0uZ2V0RWxlbWVudHNCeVRhZ05hbWUoJ3Rib2R5JylbMF0uaW5zZXJ0Um93KC0xKTtcbiAgICAgICAgLy8gSW5zZXJ0IG5ldyBjZWxscyAoPHRkPiBlbGVtZW50cykgYXQgdGhlIDFzdCBhbmQgMm5kIHBvc2l0aW9uIG9mIHRoZSBcIm5ld1wiIDx0cj4gZWxlbWVudDpcbiAgICAgICAgdmFyIGNlbGwxID0gcm93Lmluc2VydENlbGwoMCk7XG4gICAgICAgIHZhciBjZWxsMiA9IHJvdy5pbnNlcnRDZWxsKDEpO1xuICAgICAgICB2YXIgY2VsbDMgPSByb3cuaW5zZXJ0Q2VsbCgyKTtcbiAgICAgICAgdmFyIGNlbGw0ID0gcm93Lmluc2VydENlbGwoMyk7XG5cbiAgICAgICAgLy8gQWRkIHNvbWUgdGV4dCB0byB0aGUgbmV3IGNlbGxzOlxuICAgICAgICBjZWxsMS5pbm5lckhUTUwgPSBkYXRhLmlkO1xuICAgICAgICBjZWxsMi5pbm5lckhUTUwgPSBkYXRhLmNvbXBhbnkubmFtZTtcbiAgICAgICAgY2VsbDMuaW5uZXJIVE1MID0gZGF0YS5uYW1lO1xuICAgICAgICBjZWxsNC5pbm5lckhUTUwgPSBkYXRhLnByaWNlO1xuICAgIH0pO1xuICAgIC8vIGNvbnNvbGUubG9nKHBhZ2luYXRvcik7XG4gICAgdG90YWxfY291bnQuc2V0KHBheWxvYWQuY291bnQpO1xuICAgIGJ1aWxkUGFnaW5hdG9yKCk7IFxufSIsImltcG9ydCB7IHRhYmxlcywgcm93cyB9IGZyb20gJy4uL2dsb2JhbHMnO1xuaW1wb3J0IHsgcG9wdWxhdGVUYWJsZSB9IGZyb20gJy4vcG9wdWxhdGVUYWJsZSdcbi8qKlxuICogQUpBWCBSZXF1ZXN0IHRvIHNlcnZlciB0byBnZXQgVGFibGUgZGF0YS5cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGFqYXhSZXF1ZXN0KClcbntcbiAgICBsZXQgciA9IG5ldyBYTUxIdHRwUmVxdWVzdCgpO1xuICAgIFxuICAgIHIub3BlbignUE9TVCcsIHRhYmxlc1swXS5nZXRBdHRyaWJ1dGUoJ2RhdGEtdGFyZ2V0JyksIHRydWUpO1xuICAgIHIuc2V0UmVxdWVzdEhlYWRlcignWC1DU1JGLVRPS0VOJywgJ3t7IGNzcmZfdG9rZW4oKSB9fScpO1xuICAgIHIuc2V0UmVxdWVzdEhlYWRlcigndGFrZScsICcxMCcpO1xuICAgIHIuc2V0UmVxdWVzdEhlYWRlcignc2tpcCcsICc1Jyk7XG4gICAgci5zZXRSZXF1ZXN0SGVhZGVyKCdzZWFyY2gnLCAnV2l6YScpO1xuICAgIHIuYWRkRXZlbnRMaXN0ZW5lcignbG9hZCcsIGFqYXhMaXN0ZW5lcik7XG4gICAgci5vbnJlYWR5c3RhdGVjaGFuZ2UgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIGlmIChyLnJlYWR5U3RhdGUgIT0gNCB8fCByLnN0YXR1cyAhPSAyMDApIHJldHVybjsgXG4gICAgICAgIC8vIGNvbnNvbGUubG9nKHIucmVzcG9uc2VUZXh0KTtcbiAgICB9O1xuICAgIHIuc2VuZCgndGFrZT0xJyk7XG59XG5cbi8qKlxuICogQ2FsbCBiYWNrIGZ1bmN0aW9uIGZpcmVkIG9uIEFKQVggcmVzdWx0LlxuICovXG5leHBvcnQgZnVuY3Rpb24gYWpheExpc3RlbmVyKClcbntcbiAgICAvLyBjb25zb2xlLmxvZyhKU09OLnBhcnNlKHRoaXMucmVzcG9uc2VUZXh0KSk7XG4gICAgcm93cy5zZXQoSlNPTi5wYXJzZSh0aGlzLnJlc3BvbnNlVGV4dCkpO1xuICAgIC8vIGNvbnNvbGUubG9nKHJvd3MuY29sbGVjdGlvbik7XG4gICAgcG9wdWxhdGVUYWJsZShyb3dzLmNvbGxlY3Rpb24pO1xufSIsImltcG9ydCB7IGluaXRpYWxpemVUYWJsZSB9IGZyb20gJy4vbW9kdWxlcy9pbml0aWFsaXplVGFibGUnO1xuaW1wb3J0IHsgYWpheFJlcXVlc3QgfSBmcm9tICcuL21vZHVsZXMvYWpheFJlcXVlc3QnO1xuXG5pbml0aWFsaXplVGFibGUoKTtcbmFqYXhSZXF1ZXN0KCk7XG4iXSwibmFtZXMiOlsidGFibGVzIiwiZG9jdW1lbnQiLCJnZXRFbGVtZW50c0J5Q2xhc3NOYW1lIiwiaGVhZGVycyIsInNsaWNlIiwiY2FsbCIsInRIZWFkIiwicXVlcnlTZWxlY3RvckFsbCIsIm1hcCIsImhlYWRlciIsImlubmVySFRNTCIsInBhZ2luYXRvciIsImNyZWF0ZUVsZW1lbnQiLCJ0b3RhbF9jb3VudCIsInZhbHVlIiwicm93cyIsImNvbGxlY3Rpb24iLCJpbml0aWFsaXplVGFibGUiLCJ3cmFwcGVyIiwiY2xhc3NOYW1lIiwidGFibGUiLCJib2R5IiwiaW5zZXJ0QmVmb3JlIiwiYXBwZW5kQ2hpbGQiLCJidWlsZFBhZ2luYXRvciIsInBvcHVsYXRlVGFibGUiLCJwYXlsb2FkIiwiZGF0YSIsImZvckVhY2giLCJyb3ciLCJnZXRFbGVtZW50c0J5VGFnTmFtZSIsImluc2VydFJvdyIsImNlbGwxIiwiaW5zZXJ0Q2VsbCIsImNlbGwyIiwiY2VsbDMiLCJjZWxsNCIsImlkIiwiY29tcGFueSIsIm5hbWUiLCJwcmljZSIsInNldCIsImNvdW50IiwiYWpheFJlcXVlc3QiLCJyIiwiWE1MSHR0cFJlcXVlc3QiLCJvcGVuIiwiZ2V0QXR0cmlidXRlIiwic2V0UmVxdWVzdEhlYWRlciIsImFkZEV2ZW50TGlzdGVuZXIiLCJhamF4TGlzdGVuZXIiLCJvbnJlYWR5c3RhdGVjaGFuZ2UiLCJyZWFkeVN0YXRlIiwic3RhdHVzIiwic2VuZCIsIkpTT04iLCJwYXJzZSIsInJlc3BvbnNlVGV4dCJdLCJtYXBwaW5ncyI6Ijs7O0FBQU8sSUFBSUEsU0FBU0MsU0FBU0Msc0JBQVQsQ0FBZ0MsZ0JBQWhDLENBQWI7QUFDUCxBQUFPLElBQUlDLFVBQVUsR0FBR0MsS0FBSCxDQUNoQkMsSUFEZ0IsQ0FDWEwsT0FBTyxDQUFQLEVBQVVNLEtBQVYsQ0FBZ0JDLGdCQUFoQixDQUFp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
