(function () {
'use strict';

let tables = document.getElementsByClassName("eloquent-table");
let headers = [].slice
                .call(tables[0].tHead.querySelectorAll("th"))
                .map(function(header) {
                    return header.innerHTML;
                });
let paginator = document.createElement("div");
let total_count = { value: 0,
						   set: function(value) {
							this.value = value;
						 	}
						 };
let rows = { collection: null,
					set: function(value) {
						this.collection = value;
					}};

/**
 * Construct basic framework for creating a table.
 */
function initializeTable()
{
    let wrapper = document.createElement("div");
    wrapper.className = "table-wrapper";
    let table = tables[0];
    
    document.body.insertBefore(wrapper, table);
    wrapper.appendChild(table);

    // paginator = document.createElement("div");
    paginator.className = "paginator";
    wrapper.appendChild(paginator);
}

/**
 * Fired on AJAX response to construct paginated results.
 *
 */
function buildPaginator()
{
    console.log("Count: " + total_count);
    paginator.innerHTML = total_count.value;
}

/**
 * AJAX Listener to build table with data returned 
 * from server.
 *
 * @param  {Json} payload a server response
 */
function populateTable(payload)
{
    console.log(tables);
    payload.data.forEach(function(data) {
        
        var row = tables[0].getElementsByTagName('tbody')[0].insertRow(-1);
        // Insert new cells (<td> elements) at the 1st and 2nd position of the "new" <tr> element:
        var cell1 = row.insertCell(0);
        var cell2 = row.insertCell(1);
        var cell3 = row.insertCell(2);
        var cell4 = row.insertCell(3);

        // Add some text to the new cells:
        cell1.innerHTML = data.id;
        cell2.innerHTML = data.company.name;
        cell3.innerHTML = data.name;
        cell4.innerHTML = data.price;
    });
    console.log(paginator);
    total_count.set(payload.count);
    buildPaginator(); 
}

/**
 * AJAX Request to server to get Table data.
 */
function ajaxRequest()
{
    let r = new XMLHttpRequest();
    
    r.open("POST", tables[0].getAttribute("data-target"), true);
    r.setRequestHeader("X-CSRF-TOKEN", "{{ csrf_token() }}");
    r.setRequestHeader("take", "10");
    r.setRequestHeader("skip", "5");
    r.setRequestHeader("search", "Wiza");
    r.addEventListener("load", ajaxListener);
    r.onreadystatechange = function () {
        if (r.readyState != 4 || r.status != 200) return; 
        // console.log(r.responseText);
    };
    r.send("take=1");
}

/**
 * Call back function fired on AJAX result.
 */
function ajaxListener()
{
    // console.log(JSON.parse(this.responseText));
    rows.set(JSON.parse(this.responseText));
    console.log(rows.collection);
    populateTable(rows.collection);
}

initializeTable();
ajaxRequest();

}());
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibWFpbi5taW4uanMiLCJzb3VyY2VzIjpbIi4uLy4uL3NyYy9zY3JpcHRzL2dsb2JhbHMuanMiLCIuLi8uLi9zcmMvc2NyaXB0cy9tb2R1bGVzL2luaXRpYWxpemVUYWJsZS5qcyIsIi4uLy4uL3NyYy9zY3JpcHRzL21vZHVsZXMvcGFnaW5hdG9yLmpzIiwiLi4vLi4vc3JjL3NjcmlwdHMvbW9kdWxlcy9wb3B1bGF0ZVRhYmxlLmpzIiwiLi4vLi4vc3JjL3NjcmlwdHMvbW9kdWxlcy9hamF4UmVxdWVzdC5qcyIsIi4uLy4uL3NyYy9zY3JpcHRzL21haW4uanMiXSwic291cmNlc0NvbnRlbnQiOlsiZXhwb3J0IGxldCB0YWJsZXMgPSBkb2N1bWVudC5nZXRFbGVtZW50c0J5Q2xhc3NOYW1lKFwiZWxvcXVlbnQtdGFibGVcIik7XG5leHBvcnQgbGV0IGhlYWRlcnMgPSBbXS5zbGljZVxuICAgICAgICAgICAgICAgIC5jYWxsKHRhYmxlc1swXS50SGVhZC5xdWVyeVNlbGVjdG9yQWxsKFwidGhcIikpXG4gICAgICAgICAgICAgICAgLm1hcChmdW5jdGlvbihoZWFkZXIpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGhlYWRlci5pbm5lckhUTUw7XG4gICAgICAgICAgICAgICAgfSk7XG5leHBvcnQgbGV0IHBhZ2luYXRvciA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJkaXZcIik7XG5leHBvcnQgbGV0IHRvdGFsX2NvdW50ID0geyB2YWx1ZTogMCxcblx0XHRcdFx0XHRcdCAgIHNldDogZnVuY3Rpb24odmFsdWUpIHtcblx0XHRcdFx0XHRcdFx0dGhpcy52YWx1ZSA9IHZhbHVlO1xuXHRcdFx0XHRcdFx0IFx0fVxuXHRcdFx0XHRcdFx0IH07XG5leHBvcnQgbGV0IHJvd3MgPSB7IGNvbGxlY3Rpb246IG51bGwsXG5cdFx0XHRcdFx0c2V0OiBmdW5jdGlvbih2YWx1ZSkge1xuXHRcdFx0XHRcdFx0dGhpcy5jb2xsZWN0aW9uID0gdmFsdWU7XG5cdFx0XHRcdFx0fX07IiwiaW1wb3J0IHt0YWJsZXMsIGhlYWRlcnMsIHJvd3MsIHBhZ2luYXRvciwgdG90YWxfY291bnR9IGZyb20gXCIuLi9nbG9iYWxzLmpzXCI7XG4vKipcbiAqIENvbnN0cnVjdCBiYXNpYyBmcmFtZXdvcmsgZm9yIGNyZWF0aW5nIGEgdGFibGUuXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBpbml0aWFsaXplVGFibGUoKVxue1xuICAgIGxldCB3cmFwcGVyID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImRpdlwiKTtcbiAgICB3cmFwcGVyLmNsYXNzTmFtZSA9IFwidGFibGUtd3JhcHBlclwiO1xuICAgIGxldCB0YWJsZSA9IHRhYmxlc1swXTtcbiAgICBcbiAgICBkb2N1bWVudC5ib2R5Lmluc2VydEJlZm9yZSh3cmFwcGVyLCB0YWJsZSk7XG4gICAgd3JhcHBlci5hcHBlbmRDaGlsZCh0YWJsZSk7XG5cbiAgICAvLyBwYWdpbmF0b3IgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiZGl2XCIpO1xuICAgIHBhZ2luYXRvci5jbGFzc05hbWUgPSBcInBhZ2luYXRvclwiO1xuICAgIHdyYXBwZXIuYXBwZW5kQ2hpbGQocGFnaW5hdG9yKTtcbn0iLCJpbXBvcnQgeyBwYWdpbmF0b3IsIHRvdGFsX2NvdW50IH0gZnJvbSBcIi4uL2dsb2JhbHMuanNcIjtcbi8qKlxuICogRmlyZWQgb24gQUpBWCByZXNwb25zZSB0byBjb25zdHJ1Y3QgcGFnaW5hdGVkIHJlc3VsdHMuXG4gKlxuICovXG5leHBvcnQgZnVuY3Rpb24gYnVpbGRQYWdpbmF0b3IoKVxue1xuICAgIGNvbnNvbGUubG9nKFwiQ291bnQ6IFwiICsgdG90YWxfY291bnQpO1xuICAgIHBhZ2luYXRvci5pbm5lckhUTUwgPSB0b3RhbF9jb3VudC52YWx1ZTtcbn0iLCJpbXBvcnQge3RhYmxlcywgaGVhZGVycywgcm93cywgcGFnaW5hdG9yLCB0b3RhbF9jb3VudH0gZnJvbSBcIi4uL2dsb2JhbHMuanNcIjtcbmltcG9ydCB7IGJ1aWxkUGFnaW5hdG9yIH0gZnJvbSAnLi9wYWdpbmF0b3IuanMnO1xuLyoqXG4gKiBBSkFYIExpc3RlbmVyIHRvIGJ1aWxkIHRhYmxlIHdpdGggZGF0YSByZXR1cm5lZCBcbiAqIGZyb20gc2VydmVyLlxuICpcbiAqIEBwYXJhbSAge0pzb259IHBheWxvYWQgYSBzZXJ2ZXIgcmVzcG9uc2VcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIHBvcHVsYXRlVGFibGUocGF5bG9hZClcbntcbiAgICBjb25zb2xlLmxvZyh0YWJsZXMpO1xuICAgIHBheWxvYWQuZGF0YS5mb3JFYWNoKGZ1bmN0aW9uKGRhdGEpIHtcbiAgICAgICAgXG4gICAgICAgIHZhciByb3cgPSB0YWJsZXNbMF0uZ2V0RWxlbWVudHNCeVRhZ05hbWUoJ3Rib2R5JylbMF0uaW5zZXJ0Um93KC0xKTtcbiAgICAgICAgLy8gSW5zZXJ0IG5ldyBjZWxscyAoPHRkPiBlbGVtZW50cykgYXQgdGhlIDFzdCBhbmQgMm5kIHBvc2l0aW9uIG9mIHRoZSBcIm5ld1wiIDx0cj4gZWxlbWVudDpcbiAgICAgICAgdmFyIGNlbGwxID0gcm93Lmluc2VydENlbGwoMCk7XG4gICAgICAgIHZhciBjZWxsMiA9IHJvdy5pbnNlcnRDZWxsKDEpO1xuICAgICAgICB2YXIgY2VsbDMgPSByb3cuaW5zZXJ0Q2VsbCgyKTtcbiAgICAgICAgdmFyIGNlbGw0ID0gcm93Lmluc2VydENlbGwoMyk7XG5cbiAgICAgICAgLy8gQWRkIHNvbWUgdGV4dCB0byB0aGUgbmV3IGNlbGxzOlxuICAgICAgICBjZWxsMS5pbm5lckhUTUwgPSBkYXRhLmlkO1xuICAgICAgICBjZWxsMi5pbm5lckhUTUwgPSBkYXRhLmNvbXBhbnkubmFtZTtcbiAgICAgICAgY2VsbDMuaW5uZXJIVE1MID0gZGF0YS5uYW1lO1xuICAgICAgICBjZWxsNC5pbm5lckhUTUwgPSBkYXRhLnByaWNlO1xuICAgIH0pO1xuICAgIGNvbnNvbGUubG9nKHBhZ2luYXRvcik7XG4gICAgdG90YWxfY291bnQuc2V0KHBheWxvYWQuY291bnQpO1xuICAgIGJ1aWxkUGFnaW5hdG9yKCk7IFxufSIsImltcG9ydCB7dGFibGVzLCBoZWFkZXJzLCByb3dzLCBwYWdpbmF0b3IsIHRvdGFsX2NvdW50fSBmcm9tIFwiLi4vZ2xvYmFscy5qc1wiO1xuaW1wb3J0IHsgcG9wdWxhdGVUYWJsZSB9IGZyb20gJy4vcG9wdWxhdGVUYWJsZS5qcydcbi8qKlxuICogQUpBWCBSZXF1ZXN0IHRvIHNlcnZlciB0byBnZXQgVGFibGUgZGF0YS5cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGFqYXhSZXF1ZXN0KClcbntcbiAgICBsZXQgciA9IG5ldyBYTUxIdHRwUmVxdWVzdCgpO1xuICAgIFxuICAgIHIub3BlbihcIlBPU1RcIiwgdGFibGVzWzBdLmdldEF0dHJpYnV0ZShcImRhdGEtdGFyZ2V0XCIpLCB0cnVlKTtcbiAgICByLnNldFJlcXVlc3RIZWFkZXIoXCJYLUNTUkYtVE9LRU5cIiwgXCJ7eyBjc3JmX3Rva2VuKCkgfX1cIik7XG4gICAgci5zZXRSZXF1ZXN0SGVhZGVyKFwidGFrZVwiLCBcIjEwXCIpO1xuICAgIHIuc2V0UmVxdWVzdEhlYWRlcihcInNraXBcIiwgXCI1XCIpO1xuICAgIHIuc2V0UmVxdWVzdEhlYWRlcihcInNlYXJjaFwiLCBcIldpemFcIik7XG4gICAgci5hZGRFdmVudExpc3RlbmVyKFwibG9hZFwiLCBhamF4TGlzdGVuZXIpO1xuICAgIHIub25yZWFkeXN0YXRlY2hhbmdlID0gZnVuY3Rpb24gKCkge1xuICAgICAgICBpZiAoci5yZWFkeVN0YXRlICE9IDQgfHwgci5zdGF0dXMgIT0gMjAwKSByZXR1cm47IFxuICAgICAgICAvLyBjb25zb2xlLmxvZyhyLnJlc3BvbnNlVGV4dCk7XG4gICAgfTtcbiAgICByLnNlbmQoXCJ0YWtlPTFcIik7XG59XG5cbi8qKlxuICogQ2FsbCBiYWNrIGZ1bmN0aW9uIGZpcmVkIG9uIEFKQVggcmVzdWx0LlxuICovXG5leHBvcnQgZnVuY3Rpb24gYWpheExpc3RlbmVyKClcbntcbiAgICAvLyBjb25zb2xlLmxvZyhKU09OLnBhcnNlKHRoaXMucmVzcG9uc2VUZXh0KSk7XG4gICAgcm93cy5zZXQoSlNPTi5wYXJzZSh0aGlzLnJlc3BvbnNlVGV4dCkpO1xuICAgIGNvbnNvbGUubG9nKHJvd3MuY29sbGVjdGlvbik7XG4gICAgcG9wdWxhdGVUYWJsZShyb3dzLmNvbGxlY3Rpb24pO1xufSIsImltcG9ydCB7IHRhYmxlcyB9IGZyb20gJy4vZ2xvYmFscy5qcyc7XG5pbXBvcnQgeyBpbml0aWFsaXplVGFibGUgfSBmcm9tIFwiLi9tb2R1bGVzL2luaXRpYWxpemVUYWJsZVwiO1xuaW1wb3J0IHsgYWpheFJlcXVlc3QsIGFqYXhMaXN0ZW5lciB9IGZyb20gXCIuL21vZHVsZXMvYWpheFJlcXVlc3RcIjtcblxuaW5pdGlhbGl6ZVRhYmxlKCk7XG5hamF4UmVxdWVzdCgpO1xuIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7OztBQUFPLElBQUksTUFBTSxHQUFHLFFBQVEsQ0FBQyxzQkFBc0IsQ0FBQyxnQkFBZ0IsQ0FBQyxDQUFDO0FBQ3RFLEFBQU8sSUFBSSxPQUFPLEdBQUcsRUFBRSxDQUFDLEtBQUs7aUJBQ1osSUFBSSxDQUFDLE1BQU0sQ0FBQyxDQUFDLENBQUMsQ0FBQyxLQUFLLENBQUMsZ0JBQWdCLENBQUMsSUFBSSxDQUFDLENBQUM7aUJBQzVDLEdBQUcsQ0FBQyxTQUFTLE1BQU0sRUFBRTtvQkFDbEIsT0FBTyxNQUFNLENBQUMsU0FBUyxDQUFDO2lCQUMzQixDQUFDLENBQUM7QUFDbkIsQUFBTyxJQUFJLFNBQVMsR0FBRyxRQUFRLENBQUMsYUFBYSxDQUFDLEtBQUssQ0FBQyxDQUFDO0FBQ3JELEFBQU8sSUFBSSxXQUFXLEdBQUcsRUFBRSxLQUFLLEVBQUUsQ0FBQztTQUMxQixHQUFHLEVBQUUsU0FBUyxLQUFLLEVBQUU7T0FDdkIsSUFBSSxDQUFDLEtBQUssR0FBRyxLQUFLLENBQUM7U0FDakI7UUFDRCxDQUFDO0FBQ1QsQUFBTyxJQUFJLElBQUksR0FBRyxFQUFFLFVBQVUsRUFBRSxJQUFJO0tBQy9CLEdB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
